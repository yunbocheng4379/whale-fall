"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[606],{50727:function(se,V,n){var p=n(4942),k=n(97685),$=n(45987),M=n(74165),q=n(15861),a=n(1413),ee=n(24969),F=n(97462),L=n(952),ne=n(89451),J=n(48171),te=n(53914),N=n(22270),G=n(60249),H=n(83622),re=n(23323),ae=n(21770),E=n(88306),z=n(8880),m=n(67294),ie=n(12),d=n(85893),Y=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],b=["record","position","creatorButtonText","newRecordType","parentKey","style"],A=m.createContext(void 0);function Q(e){var O=e.children,K=e.record,g=e.position,R=e.newRecordType,c=e.parentKey,C=(0,m.useContext)(A);return m.cloneElement(O,(0,a.Z)((0,a.Z)({},O.props),{},{onClick:function(){var v=(0,q.Z)((0,M.Z)().mark(function D(T){var h,y,B,I;return(0,M.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(h=(y=O.props).onClick)===null||h===void 0?void 0:h.call(y,T);case 2:if(I=s.sent,I!==!1){s.next=5;break}return s.abrupt("return");case 5:C==null||(B=C.current)===null||B===void 0||B.addEditRecord(K,{position:g,newRecordType:R,parentKey:c});case 6:case"end":return s.stop()}},D)}));function f(D){return v.apply(this,arguments)}return f}()}))}function U(e){var O,K,g=(0,ne.YB)(),R=e.onTableChange,c=e.maxLength,C=e.formItemProps,v=e.recordCreatorProps,f=e.rowKey,D=e.controlled,T=e.defaultValue,h=e.onChange,y=e.editableFormRef,B=(0,$.Z)(e,Y),I=(0,m.useRef)(void 0),W=(0,m.useRef)(),s=(0,m.useRef)();(0,m.useImperativeHandle)(B.actionRef,function(){return W.current},[W.current]);var ce=(0,ae.Z)(function(){return e.value||T||[]},{value:e.value,onChange:e.onChange}),ue=(0,k.Z)(ce,2),_=ue[0],ve=ue[1],Z=m.useMemo(function(){return typeof f=="function"?f:function(t,u){return t[f]||u}},[f]),le=(0,J.J)(function(t){if(typeof t=="number"&&!e.name){if(t>=_.length)return t;var u=_&&_[t];return Z==null?void 0:Z(u,t)}if((typeof t=="string"||t>=_.length)&&e.name){var r=_.findIndex(function(l,o){var i;return(Z==null||(i=Z(l,o))===null||i===void 0?void 0:i.toString())===(t==null?void 0:t.toString())});if(r!==-1)return r}return t});(0,m.useImperativeHandle)(y,function(){var t=function(l){var o,i;if(l==null)throw new Error("rowIndex is required");var P=le(l),j=[e.name,(o=P==null?void 0:P.toString())!==null&&o!==void 0?o:""].flat(1).filter(Boolean);return(i=s.current)===null||i===void 0?void 0:i.getFieldValue(j)},u=function(){var l,o=[e.name].flat(1).filter(Boolean);if(Array.isArray(o)&&o.length===0){var i,P=(i=s.current)===null||i===void 0?void 0:i.getFieldsValue();return Array.isArray(P)?P:Object.keys(P).map(function(j){return P[j]})}return(l=s.current)===null||l===void 0?void 0:l.getFieldValue(o)};return(0,a.Z)((0,a.Z)({},s.current),{},{getRowData:t,getRowsData:u,setRowData:function(l,o){var i,P;if(l==null)throw new Error("rowIndex is required");var j=le(l),S=[e.name,(i=j==null?void 0:j.toString())!==null&&i!==void 0?i:""].flat(1).filter(Boolean),Oe=Object.assign({},(0,a.Z)((0,a.Z)({},t(l)),o||{})),Ce=(0,z.Z)({},S,Oe);return(P=s.current)===null||P===void 0||P.setFieldsValue(Ce),!0}})},[le,e.name,s.current]),(0,m.useEffect)(function(){e.controlled&&(_||[]).forEach(function(t,u){var r;(r=s.current)===null||r===void 0||r.setFieldsValue((0,p.Z)({},"".concat(Z(t,u)),t))},{})},[(0,te.ZP)(_),e.controlled]),(0,m.useEffect)(function(){if(e.name){var t;s.current=e==null||(t=e.editable)===null||t===void 0?void 0:t.form}},[(O=e.editable)===null||O===void 0?void 0:O.form,e.name]);var x=v||{},fe=x.record,oe=x.position,me=x.creatorButtonText,Ee=x.newRecordType,he=x.parentKey,Pe=x.style,De=(0,$.Z)(x,b),de=oe==="top",w=(0,m.useMemo)(function(){return typeof c=="number"&&c<=(_==null?void 0:_.length)?!1:v!==!1&&(0,d.jsx)(Q,{record:(0,N.h)(fe,_==null?void 0:_.length,_)||{},position:oe,parentKey:(0,N.h)(he,_==null?void 0:_.length,_),newRecordType:Ee,children:(0,d.jsx)(H.ZP,(0,a.Z)((0,a.Z)({type:"dashed",style:(0,a.Z)({display:"block",margin:"10px 0",width:"100%"},Pe),icon:(0,d.jsx)(ee.Z,{})},De),{},{children:me||g.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[v,c,_==null?void 0:_.length]),ge=(0,m.useMemo)(function(){return w?de?{components:{header:{wrapper:function(u){var r,l=u.className,o=u.children;return(0,d.jsxs)("thead",{className:l,children:[o,(0,d.jsxs)("tr",{style:{position:"relative"},children:[(0,d.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:w}),(0,d.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(r=B.columns)===null||r===void 0?void 0:r.length,children:w})]})]})}}}}:{tableViewRender:function(u,r){var l,o;return(0,d.jsxs)(d.Fragment,{children:[(l=(o=e.tableViewRender)===null||o===void 0?void 0:o.call(e,u,r))!==null&&l!==void 0?l:r,w]})}}:{}},[de,w]),_e=(0,a.Z)({},e.editable),Me=(0,J.J)(function(t,u){var r,l,o;if((r=e.editable)===null||r===void 0||(l=r.onValuesChange)===null||l===void 0||l.call(r,t,u),(o=e.onValuesChange)===null||o===void 0||o.call(e,u,t),e.controlled){var i;e==null||(i=e.onChange)===null||i===void 0||i.call(e,u)}});return(e!=null&&e.onValuesChange||(K=e.editable)!==null&&K!==void 0&&K.onValuesChange||e.controlled&&e!==null&&e!==void 0&&e.onChange)&&(_e.onValuesChange=Me),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(A.Provider,{value:W,children:(0,d.jsx)(ie.Z,(0,a.Z)((0,a.Z)((0,a.Z)({search:!1,options:!1,pagination:!1,rowKey:f,revalidateOnFocus:!1},B),ge),{},{tableLayout:"fixed",actionRef:W,onChange:R,editable:(0,a.Z)((0,a.Z)({},_e),{},{formProps:(0,a.Z)({formRef:s},_e.formProps)}),dataSource:_,onDataSourceChange:function(u){if(ve(u),e.name&&oe==="top"){var r,l=(0,z.Z)({},[e.name].flat(1).filter(Boolean),u);(r=s.current)===null||r===void 0||r.setFieldsValue(l)}}}))}),e.name?(0,d.jsx)(F.Z,{name:[e.name],children:function(u){var r,l;if(!I.current)return I.current=_,null;var o=(0,E.Z)(u,[e.name].flat(1)),i=o==null?void 0:o.find(function(P,j){var S;return!(0,G.A)(P,(S=I.current)===null||S===void 0?void 0:S[j])});return I.current=_,i&&(e==null||(r=e.editable)===null||r===void 0||(l=r.onValuesChange)===null||l===void 0||l.call(r,i,o)),null}}):null]})}function X(e){var O=L.ZP.useFormInstance();return e.name?(0,d.jsx)(re.Z.Item,(0,a.Z)((0,a.Z)({style:{maxWidth:"100%"},shouldUpdate:function(g,R){var c=[e.name].flat(1);try{return JSON.stringify((0,E.Z)(g,c))!==JSON.stringify((0,E.Z)(R,c))}catch(C){return!0}}},e==null?void 0:e.formItemProps),{},{name:e.name,children:(0,d.jsx)(U,(0,a.Z)((0,a.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e),{},{editable:(0,a.Z)((0,a.Z)({},e.editable),{},{form:O})}))})):(0,d.jsx)(U,(0,a.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e))}X.RecordCreator=Q,V.Z=X},82485:function(se,V,n){n.r(V);var p=n(19632),k=n.n(p),$=n(15009),M=n.n($),q=n(99289),a=n.n(q),ee=n(5574),F=n.n(ee),L=n(67294),ne=n(90930),J=n(50727),te=n(88245),N=n(22876),G=n(83062),H=n(83622),re=n(86548),ae=n(29817),E=n(85893),z=[{id:1,networkSegment:"10.10.10.1/24"},{id:2,networkSegment:"10.11.12.1/30"}],m=function(){var d=(0,L.useState)(z),Y=F()(d,2),b=Y[0],A=Y[1],Q=(0,L.useState)([]),U=F()(Q,2),X=U[0],e=U[1],O=(0,L.useRef)(),K=[{title:"\u7F51\u6BB5",dataIndex:"networkSegment",align:"center",valueType:"input",tooltip:"\u793A\u4F8B\uFF1A10.10.10.x/24",copyable:!0,formItemProps:function(){return{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"},{message:"\u8BF7\u6309\u7167\u7F51\u6BB5\u89C4\u5219\u586B\u5199\uFF0C\u63A9\u7801\u4F4D\u6570\u8303\u56F4[24,30]",pattern:/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\/(2[4-9]|30)$/,validateTrigger:"onBlur"}]}}},{title:"\u64CD\u4F5C",align:"center",valueType:"option",render:function(R,c,C,v){return[(0,E.jsx)(G.Z,{title:"\u7F16\u8F91",children:(0,E.jsx)(H.ZP,{icon:(0,E.jsx)(re.Z,{}),onClick:a()(M()().mark(function f(){var D;return M()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:v==null||(D=v.startEditable)===null||D===void 0||D.call(v,c.id);case 1:case"end":return h.stop()}},f)}))})},"edit"),(0,E.jsx)(G.Z,{title:"\u5220\u9664",children:(0,E.jsx)(H.ZP,{icon:(0,E.jsx)(ae.Z,{}),onClick:a()(M()().mark(function f(){return M()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:A(b.filter(function(h){return h.id!==c.id}));case 1:case"end":return T.stop()}},f)}))})},"delete")]}}];return(0,E.jsxs)(ne._z,{children:[(0,E.jsx)(J.Z,{rowKey:"id",columns:K,value:b,actionRef:O,headerTitle:"\u53EF\u7F16\u8F91\u8868\u683C",recordCreatorProps:{record:function(){return{id:parseInt((Math.random()*1e5).toFixed(0))}},creatorButtonText:"\u6DFB\u52A0\u7F51\u6BB5"},maxLength:10,pagination:!1,editable:{type:"multiple",editableKeys:X,onChange:e,onlyAddOneLineAlertMessage:"\u8BF7\u5148\u4FDD\u5B58\u4E0A\u4E00\u884C\u6570\u636E\uFF0C\u518D\u8FDB\u884C\u65B0\u589E",onDelete:function(){var g=a()(M()().mark(function c(C){return M()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:A(b.filter(function(D){return D.id!==C}));case 1:case"end":return f.stop()}},c)}));function R(c){return g.apply(this,arguments)}return R}(),onSave:function(){var g=a()(M()().mark(function c(C,v,f){var D;return M()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:D=b.find(function(y){return y.id===C}),A(D?b.map(function(y){return y.id===v.id?v:y}):[].concat(k()(b),[v]));case 2:case"end":return h.stop()}},c)}));function R(c,C,v){return g.apply(this,arguments)}return R}()}}),(0,E.jsx)(te.Z,{title:"\u8868\u683C\u6570\u636E",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,E.jsx)(N.Z,{ignoreFormItem:!0,fieldProps:{style:{width:"100%"}},mode:"read",valueType:"jsonCode",text:JSON.stringify(b)})})]})};V.default=m}}]);
